import{_ as et,u as tt,e as st,f as nt,r as _,n as ot,c as d,a as n,g as T,h as P,i as R,w as me,t as a,b as o,v as ye,F as $,j as E,k as ge,l as it,d as at,o as p}from"./index-CdMgmJf8.js";import{u as lt}from"./session-CmAxeuMf.js";const rt={class:"explore-page"},ct={class:"explore-container"},ut={class:"panel-title"},dt=["disabled"],pt=["value"],vt={class:"panel-title mt-2"},ft=["disabled"],ht=["value"],_t={class:"panel-title mt-2"},mt={class:"version-toggle"},yt=["disabled"],gt=["disabled"],kt=["disabled"],bt={key:0,class:"spinner"},xt={key:1},St={key:0,class:"analysis-info mt-2"},wt={class:"info-text"},Ct={class:"info-text"},Tt={class:"info-text"},Pt={class:"player-section mt-3"},Lt={class:"panel-title"},At={class:"song-id"},Mt={key:0,class:"loading-indicator"},Rt={key:1,class:"error-indicator"},$t={class:"player-controls"},Et=["disabled"],Ft=["disabled"],Ht=["disabled"],Bt={class:"time-display"},qt={class:"task-progress mt-2"},Vt={class:"progress-text"},It={key:0,class:"progress-text"},Ot={key:1,class:"cluster-reps mt-3"},Xt={class:"panel-title"},Yt=["onClick"],zt={class:"cluster-song"},Nt={class:"plot-area"},Wt={class:"plot-header"},Qt={class:"plot-title"},Ut={class:"plot-subtitle"},Gt={key:0,class:"toast-notification"},Jt={class:"plot-wrapper"},Kt={class:"y-axis-outer"},Zt=["innerHTML"],Dt={class:"y-axis-name"},jt=["innerHTML"],es={key:0,class:"transition-overlay"},ts={class:"transition-card"},ss=["innerHTML"],ns={key:1,class:"transition-overlay"},os={class:"transition-card"},is={class:"x-axis-container"},as={class:"axis-pole left"},ls={class:"axis-name"},rs={class:"axis-pole right"},cs={key:0,class:"questionnaire-panel card"},us={class:"panel-title"},ds={key:0},ps={class:"scrollable-questions"},vs={class:"question-text"},fs={key:0,class:"text-input-group"},hs=["value","onInput"],_s={key:1,class:"likert-group"},ms=["onClick"],ys={key:0,class:"final-questions"},gs={class:"question-item"},ks={class:"question-text"},bs={class:"preference-options"},xs=["onClick"],Ss={class:"question-item"},ws={class:"question-text"},Cs={class:"preference-options"},Ts=["onClick"],Ps={class:"question-item"},Ls={class:"question-text"},As={class:"preference-options"},Ms=["onClick"],Rs={class:"question-item"},$s={class:"question-text"},Es={class:"preference-options"},Fs=["onClick"],Hs={class:"question-item"},Bs={class:"question-text"},qs=["value"],Vs={class:"panel-footer mt-2"},Is=["disabled"],Os={key:0,class:"spinner"},Xs={key:1},Ys={key:2},zs={key:3},Ns=["disabled"],Ws={key:2,class:"text-xs text-red-400 mt-1"},re="",Qs="https://neon.zeabur.app",Us={__name:"ExplorePage",setup(Gs){const{t:l,locale:ke}=tt(),be=at(),t=lt(),K=_(null),ce=_(null),H=_(null),Z=_([]),D=_([]),xe=[{id:"genreEmotionMatch"},{id:"transitionNatural"},{id:"hasJump",type:"text"},{id:"axisUnderstandable"}],Se=[{id:"genreEmotionMatchFree"},{id:"discoverability"},{id:"serendipity"},{id:"coherence"},{id:"satisfaction"},{id:"axisNavigation"},{id:"clusterDistinct"}],j=["a","b","same"],x=_("POP"),S=_("Happiness"),I=_(!1),W=_(null),L=_([]),O=_([]),A=_({x:"PC1",xR:"0.00",xLow:"",xHigh:"",y:"PC2",yR:"0.00",yLow:"",yHigh:""}),Q=_(""),ue=R(()=>t.taskStep==="transition"),X=R(()=>["welcome","guided_A","guided_B","final"].includes(t.taskStep)),we=R(()=>t.taskStep.includes("guided")?xe:t.taskStep.includes("free")?Se:[]),Ce=R(()=>t.taskStep.includes("guided")?l("ui.guidedTask"):t.taskStep.includes("free")?l("ui.freeExplore"):t.taskStep==="final"?l("questionnaire.preference"):""),Te=R(()=>t.taskStep.includes("guided")?l("task.guidedInstruction"):t.taskStep.includes("free")?l("task.freeExploreInstruction"):l("explorer.clickToPlay")),m=_(null),F=_(!1),B=_(!1),U=_(null),ie=_(0),ee=_(0),G=_(30),de=_(0),Y=_(0),te=_({minX:-6,maxX:6,minY:-5,maxY:5}),pe=["#667eea","#f59e0b","#10b981","#ef4444","#8b5cf6","#06b6d4"];function ve(s){return pe[s%pe.length]}const Pe=R(()=>A.value.yHigh.replace(/ \/ /g,"<br>")),Le=R(()=>A.value.yLow.replace(/ \/ /g,"<br>"));st(async()=>{await Ae(),t.taskStep==="guided_A"&&z(),window.addEventListener("resize",N)}),nt(()=>{window.removeEventListener("resize",N)});async function Ae(){try{const r=await(await fetch(`${re}/api/info`)).json();Z.value=r.genres,D.value=r.emotions,Z.value.includes("POP")&&(x.value="POP"),D.value.includes("Happiness")&&(S.value="Happiness")}catch(s){console.error("Failed to load info",s),Z.value=["POP"],D.value=["Happiness"]}}function Me(){t.initSession(),t.taskStep="guided_A",t.currentTaskType="guided",t.currentVersion="A",z()}function Re(){t.taskStep="free_setup"}async function $e(){if(t.taskStep==="free_setup"||t.taskStep.includes("free")){I.value=!0;try{if(!(await(await fetch(`${re}/api/check`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({genre:x.value,emotion:S.value})})).json()).valid){le(l("ui.insufficientSongs")),I.value=!1;return}z()}catch(s){console.error("Check failed:",s),z()}}else z()}function Ee(){switch(t.resetListenedForTask(),t.taskStep){case"guided_A":t.taskStep="guided_B",t.currentVersion="B",se("B");break;case"guided_B":t.taskStep="transition";break;case"free_A":t.taskStep="free_B",t.currentVersion="B",se("B");break;case"free_B":t.taskStep="final";break}}const ae=R(()=>t.taskStep.includes("guided")?t.canProceedFromGuided():t.taskStep.includes("free")?t.canProceedFromFree():!0),Fe=R(()=>ae.value?"":t.taskStep.includes("guided")?l("task.progress.minRequired",{min:1}):t.taskStep.includes("free")?l("task.progress.minRequired",{min:3}):"");function se(s){t.currentVersion=s,x.value&&S.value&&z()}async function z(s=!1){if(!(!x.value||!S.value)){I.value=!0,Q.value="",t.currentGenre=x.value,t.currentEmotion=S.value;try{const e=await(await fetch(`${re}/api/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({genre:x.value,emotion:S.value,version:t.currentVersion,version_mapping:t.versionMapping,auto_k:!0,manual_k:3})})).json();if(e.error&&e.count<3&&s){le(l("ui.insufficientSongs"));return}if(t.taskStep==="free_setup"&&!e.error&&(t.taskStep="free_A",t.currentTaskType="free",t.currentVersion="A"),e.error){console.error("Analysis error:",e.error),L.value=[],O.value=[],N();return}W.value=e,L.value=e.points,O.value=e.cluster_reps.map((c,i)=>({...c,color:ve(i)})),e.axis&&He(e.axis),Be(),await ot(),N()}catch(r){console.error("Analysis failed:",r),s&&le(l("ui.loadFailed"))}finally{I.value=!1}}}function le(s){Q.value=s,setTimeout(()=>{Q.value=""},3e3)}function He(s){const r=ke.value,e=i=>typeof i=="string"?i:(i==null?void 0:i[r])||(i==null?void 0:i.en)||"PC",c=(i,v)=>{if(!i)return"";const h=i[r]||i.en||i,u=(h==null?void 0:h[v])||h||"";return typeof u=="string"?u.split(`
`).join(" / "):""};A.value={x:e(s.x.label),xR:s.x.r||"0.00",xLow:c(s.x.polarity,"low"),xHigh:c(s.x.polarity,"high"),y:e(s.y.label),yR:s.y.r||"0.00",yLow:c(s.y.polarity,"low"),yHigh:c(s.y.polarity,"high")}}function Be(){if(L.value.length>0){const s=L.value.map(c=>c.x),r=L.value.map(c=>c.y),e=.5;te.value={minX:Math.min(...s)-e,maxX:Math.max(...s)+e,minY:Math.min(...r)-e,maxY:Math.max(...r)+e}}}function N(){var _e;const s=K.value,r=ce.value;if(!s||!r)return;const e=r.getBoundingClientRect(),c=window.devicePixelRatio||1;s.width=e.width*c,s.height=e.height*c,s.style.width=e.width+"px",s.style.height=e.height+"px";const i=s.getContext("2d");i.scale(c,c);const v=e.width,h=e.height,u={left:50,right:20,top:20,bottom:40},g=v-u.left-u.right,w=h-u.top-u.bottom;i.fillStyle="rgba(15, 15, 26, 0.9)",i.fillRect(0,0,v,h),i.strokeStyle="rgba(255, 255, 255, 0.1)",i.lineWidth=1;for(let f=0;f<=10;f++){const y=u.left+f/10*g;i.beginPath(),i.moveTo(y,u.top),i.lineTo(y,h-u.bottom),i.stroke();const C=u.top+f/10*w;i.beginPath(),i.moveTo(u.left,C),i.lineTo(v-u.right,C),i.stroke()}if(i.strokeStyle="rgba(255, 255, 255, 0.3)",i.lineWidth=2,i.beginPath(),i.moveTo(u.left,h-u.bottom),i.lineTo(v-u.right,h-u.bottom),i.moveTo(u.left,h-u.bottom),i.lineTo(u.left,u.top),i.stroke(),L.value.length===0){i.fillStyle="rgba(255, 255, 255, 0.5)",i.font="14px Inter",i.textAlign="center",i.fillText(((_e=W.value)==null?void 0:_e.error)||(t.taskStep==="transition"?"Ready to free explore":"No data"),v/2,h/2);return}const{minX:k,maxX:M,minY:b,maxY:q}=te.value;function V(f){return u.left+(f-k)/(M-k)*g}function J(f){return h-u.bottom-(f-b)/(q-b)*w}for(const f of L.value){const y=V(f.x),C=J(f.y),oe=t.getListenedState(f.id),De=t.isLiked(f.id),je=f.id===m.value;i.beginPath(),i.arc(y,C,5,0,Math.PI*2),oe==="listened"?(i.fillStyle=f.color+"AA",i.fill(),i.strokeStyle="#10b981",i.lineWidth=2,i.stroke()):oe==="skipped"?(i.fillStyle=f.color+"88",i.fill(),i.strokeStyle="#6b7280",i.lineWidth=1.5,i.stroke()):(i.fillStyle=f.color,i.fill()),je&&(i.strokeStyle="white",i.lineWidth=3,i.stroke()),De&&(i.fillStyle="#ef4444",i.font="10px sans-serif",i.fillText("â¤",y-5,C-8))}for(let f=0;f<O.value.length;f++){const y=O.value[f],C=V(y.x),oe=J(y.y);qe(i,C,oe,5,12,6,y.color)}i.fillStyle="rgba(255, 255, 255, 0.5)",i.font="10px Inter",i.textAlign="center";const Ke=(M-k)/5;for(let f=0;f<=5;f++){const y=k+f*Ke,C=V(y);i.fillText(y.toFixed(1),C,h-u.bottom+15)}i.textAlign="right";const Ze=(q-b)/5;for(let f=0;f<=5;f++){const y=b+f*Ze,C=J(y);i.fillText(y.toFixed(1),u.left-5,C+3)}}function qe(s,r,e,c,i,v,h){let u=Math.PI/2*3,g=r,w=e;const k=Math.PI/c;s.beginPath(),s.moveTo(r,e-i);for(let M=0;M<c;M++)g=r+Math.cos(u)*i,w=e+Math.sin(u)*i,s.lineTo(g,w),u+=k,g=r+Math.cos(u)*v,w=e+Math.sin(u)*v,s.lineTo(g,w),u+=k;s.lineTo(r,e-i),s.closePath(),s.fillStyle=h,s.fill(),s.strokeStyle="white",s.lineWidth=1.5,s.stroke()}function Ve(s){if(t.taskStep==="welcome"||t.taskStep==="transition")return;const e=K.value.getBoundingClientRect(),c=s.clientX-e.left,i=s.clientY-e.top,v={left:50,right:20,top:20,bottom:40},h=e.width-v.left-v.right,u=e.height-v.top-v.bottom,{minX:g,maxX:w,minY:k,maxY:M}=te.value;for(const b of L.value){const q=v.left+(b.x-g)/(w-g)*h,V=e.height-v.bottom-(b.y-k)/(M-k)*u;if(Math.abs(c-q)<10&&Math.abs(i-V)<10){fe(b.id,b.x,b.y);break}}}function Ie(s){if(t.taskStep==="welcome"||t.taskStep==="transition")return;const r=K.value,e=r.getBoundingClientRect(),c=s.clientX-e.left,i=s.clientY-e.top,v={left:50,right:20,top:20,bottom:40},h=e.width-v.left-v.right,u=e.height-v.top-v.bottom,{minX:g,maxX:w,minY:k,maxY:M}=te.value;let b=!1;for(const q of L.value){const V=v.left+(q.x-g)/(w-g)*h,J=e.height-v.bottom-(q.y-k)/(M-k)*u;if(Math.abs(c-V)<10&&Math.abs(i-J)<10){b=!0;break}}r.style.cursor=b?"pointer":"default"}let ne=!1;function Oe(){if(ne)return;ne=!0;const s=H.value;B.value=!1,de.value=s.duration,Y.value=Math.max(0,de.value/2-15),s.currentTime=Y.value,G.value=30,s.play(),F.value=!0,t.recordPlayStart(m.value),N()}function Xe(s){console.error("Audio error:",s),B.value=!1,U.value="Failed",ne=!1}function Ye(){const s=H.value;if(!s)return;const r=s.currentTime-Y.value;ee.value=Math.max(0,r),G.value>0&&(ie.value=ee.value/G.value*100),r>=30&&(s.pause(),F.value=!1,t.recordPlayEnd())}function ze(){const s=H.value;s&&(G.value=Math.min(s.duration,30))}function Ne(){F.value=!1,t.recordPlayEnd()}async function fe(s,r=null,e=null){t.recordPlayEnd(),m.value=s,B.value=!0,U.value=null,ne=!1,r!==null&&e!==null&&t.recordClick(s,r,e);try{const c=`${Qs}/song/url?id=${s}`,v=await(await fetch(c)).json();if(v.data&&v.data[0]&&v.data[0].url){const h=H.value;h.src=v.data[0].url,h.load()}else B.value=!1,U.value="No URL"}catch{B.value=!1,U.value="Error"}}function We(){m.value&&(t.toggleLike(m.value),N())}function Qe(){const s=H.value;!s||!m.value||(F.value?(s.pause(),F.value=!1):((s.currentTime>=Y.value+30||s.currentTime<Y.value)&&(s.currentTime=Y.value),s.play(),F.value=!0))}function Ue(){const s=H.value;s&&(s.pause(),s.currentTime=0,F.value=!1,ie.value=0,ee.value=0)}function Ge(){}function he(s){const r=Math.floor(s/60),e=Math.floor(s%60);return`${r}:${e.toString().padStart(2,"0")}`}async function Je(){await t.submitSession()&&setTimeout(()=>{be.push("/complete")},1500)}return(s,r)=>(p(),d("div",rt,[n("div",ct,[n("aside",{class:P(["control-panel card",{disabled:X.value}])},[n("h3",ut,a(o(l)("explorer.selectGenre")),1),me(n("select",{"onUpdate:modelValue":r[0]||(r[0]=e=>x.value=e),class:"form-select",disabled:X.value},[(p(!0),d($,null,E(Z.value,e=>(p(),d("option",{key:e,value:e},a(o(l)(`genres.${e}`)||e),9,pt))),128))],8,dt),[[ye,x.value]]),n("h3",vt,a(o(l)("explorer.selectEmotion")),1),me(n("select",{"onUpdate:modelValue":r[1]||(r[1]=e=>S.value=e),class:"form-select",disabled:X.value},[(p(!0),d($,null,E(D.value,e=>(p(),d("option",{key:e,value:e},a(o(l)(`emotions.${e}`)||e),9,ht))),128))],8,ft),[[ye,S.value]]),n("h3",_t,a(o(l)("explorer.selectVersion")),1),n("div",mt,[n("button",{class:P(["version-btn",{active:o(t).currentVersion==="A"}]),onClick:r[2]||(r[2]=e=>se("A")),disabled:X.value},a(o(l)("common.versionA")),11,yt),n("button",{class:P(["version-btn",{active:o(t).currentVersion==="B"}]),onClick:r[3]||(r[3]=e=>se("B")),disabled:X.value},a(o(l)("common.versionB")),11,gt)]),n("button",{class:"btn btn-primary mt-2 analyze-btn",onClick:$e,disabled:I.value||X.value&&o(t).taskStep!=="free_setup"&&!ue.value},[I.value?(p(),d("span",bt)):(p(),d("span",xt,a(o(l)("common.analyze")),1))],8,kt),W.value?(p(),d("div",St,[n("p",wt,a(x.value)+" + "+a(S.value),1),n("p",Ct,a(o(l)("common.total")||"Total")+": "+a(W.value.count)+" "+a(o(l)("common.songs")||"songs"),1),n("p",Tt,"K = "+a(W.value.k),1)])):T("",!0),n("div",Pt,[n("h3",Lt,a(o(l)("explorer.nowPlaying")),1),n("p",At,a(m.value||"-"),1),B.value?(p(),d("div",Mt,[r[5]||(r[5]=n("span",{class:"spinner"},null,-1)),n("span",null,a(o(l)("ui.loadingMusic")),1)])):U.value?(p(),d("div",Rt,[n("span",null,"âš ï¸ "+a(o(l)("ui.loadFailed")),1)])):T("",!0),n("audio",{ref_key:"audioPlayer",ref:H,onTimeupdate:Ye,onEnded:Ne,onLoadedmetadata:ze,onCanplay:Oe,onError:Xe},null,544),n("div",$t,[n("button",{class:"player-btn",onClick:Qe,disabled:!m.value||B.value},a(F.value?"â¸":"â–¶"),9,Et),n("button",{class:"player-btn",onClick:Ue,disabled:!m.value},"â– ",8,Ft),n("button",{class:P(["player-btn like-btn",{liked:m.value&&o(t).isLiked(m.value)}]),onClick:We,disabled:!m.value},a(m.value&&o(t).isLiked(m.value)?"â¤ï¸":"ðŸ¤"),11,Ht)]),n("div",{class:"progress-bar",onClick:Ge},[n("div",{class:"progress-fill",style:ge({width:ie.value+"%"})},null,4)]),n("div",Bt,a(he(ee.value))+" / "+a(he(G.value)),1),n("div",qt,[n("p",Vt,a(o(l)("task.progress.listened").replace("{count}",o(t).getListenedCount())),1),o(t).currentTaskType==="free"?(p(),d("p",It,a(o(l)("task.progress.liked").replace("{count}",o(t).getLikedCount()).replace("{total}","3")),1)):T("",!0)])]),O.value.length>0?(p(),d("div",Ot,[n("h3",Xt,a(o(l)("explorer.clusterReps")),1),(p(!0),d($,null,E(O.value,(e,c)=>(p(),d("div",{key:c,class:P(["cluster-rep-item",{active:m.value===e.id}]),onClick:i=>fe(e.id)},[n("span",{class:"cluster-label",style:ge({background:ve(c)})},"C"+a(c+1),5),n("span",zt,a(e.id),1)],10,Yt))),128))])):T("",!0)],2),n("main",Nt,[n("div",Wt,[n("span",Qt,a(x.value)+" - "+a(S.value),1),n("span",Ut,a(Te.value),1)]),Q.value?(p(),d("div",Gt,a(Q.value),1)):T("",!0),n("div",Jt,[n("div",Kt,[n("div",{class:"y-pole-top",innerHTML:Pe.value},null,8,Zt),n("div",Dt,a(A.value.y)+" (râ‰ˆ"+a(A.value.yR)+")",1),n("div",{class:"y-pole-bottom",innerHTML:Le.value},null,8,jt)]),n("div",{class:"plot-container",ref_key:"plotContainer",ref:ce},[n("canvas",{ref_key:"plotCanvas",ref:K,onClick:Ve,onMousemove:Ie},null,544),ue.value?(p(),d("div",es,[n("div",ts,[n("h2",null,a(o(l)("transition.title")),1),n("p",null,a(o(l)("transition.intro")),1),n("p",{innerHTML:o(l)("transition.step1")},null,8,ss),n("button",{class:"btn btn-primary",onClick:Re},a(o(l)("transition.start")),1)])])):T("",!0),o(t).taskStep==="welcome"?(p(),d("div",ns,[n("div",os,[n("h2",null,a(o(l)("welcome.title")),1),n("p",null,a(o(l)("welcome.intro")),1),n("p",null,a(o(l)("welcome.step1")),1),n("button",{class:"btn btn-primary",onClick:Me},a(o(l)("welcome.start")),1)])])):T("",!0)],512)]),n("div",is,[n("span",as,a(A.value.xLow),1),n("span",ls,a(A.value.x)+" (râ‰ˆ"+a(A.value.xR)+")",1),n("span",rs,a(A.value.xHigh),1)])]),o(t).taskStep!=="welcome"&&o(t).taskStep!=="transition"?(p(),d("aside",cs,[n("h3",us,[it(a(Ce.value)+" ",1),o(t).currentVersion?(p(),d("span",ds,"("+a(o(l)("common.version"+o(t).currentVersion))+")",1)):T("",!0)]),n("div",ps,[(p(!0),d($,null,E(we.value,e=>(p(),d("div",{class:"question-item",key:e.id},[n("p",vs,a(o(l)(`newQuestions.${e.id}`,{genre:o(l)(`genres.${x.value}`),emotion:o(l)(`emotions.${S.value}`)})||o(l)(`questionnaire.${e.id}`,{genre:o(l)(`genres.${x.value}`),emotion:o(l)(`emotions.${S.value}`)})),1),e.type==="text"?(p(),d("div",fs,[n("textarea",{value:o(t).getResponse(e.id),onInput:c=>o(t).setResponse(e.id,c.target.value),class:"feedback-input",rows:"3"},null,40,hs)])):(p(),d("div",_s,[(p(),d($,null,E(5,c=>n("button",{key:c,class:P(["likert-option",{selected:o(t).getResponse(e.id)===c}]),onClick:i=>o(t).setResponse(e.id,c)},a(c),11,ms)),64))]))]))),128)),o(t).taskStep==="final"?(p(),d("div",ys,[n("div",gs,[n("p",ks,a(o(l)("newQuestions.easierToFind")),1),n("div",bs,[(p(),d($,null,E(j,e=>n("button",{key:e,class:P(["preference-btn",{selected:o(t).getFinalResponse("discovery")===e}]),onClick:c=>o(t).setFinalResponse("discovery",e)},a(o(l)(`questionnaire.preferenceOptions.${e}`)),11,xs)),64))])]),n("div",Ss,[n("p",ws,a(o(l)("newQuestions.betterAxisLabels")),1),n("div",Cs,[(p(),d($,null,E(j,e=>n("button",{key:e,class:P(["preference-btn",{selected:o(t).getFinalResponse("axis")===e}]),onClick:c=>o(t).setFinalResponse("axis",e)},a(o(l)(`questionnaire.preferenceOptions.${e}`)),11,Ts)),64))])]),n("div",Ps,[n("p",Ls,a(o(l)("newQuestions.betterLayout")),1),n("div",As,[(p(),d($,null,E(j,e=>n("button",{key:e,class:P(["preference-btn",{selected:o(t).getFinalResponse("layout")===e}]),onClick:c=>o(t).setFinalResponse("layout",e)},a(o(l)(`questionnaire.preferenceOptions.${e}`)),11,Ms)),64))])]),n("div",Rs,[n("p",$s,a(o(l)("newQuestions.overallPreference")),1),n("div",Es,[(p(),d($,null,E(j,e=>n("button",{key:e,class:P(["preference-btn",{selected:o(t).getFinalResponse("overall")===e}]),onClick:c=>o(t).setFinalResponse("overall",e)},a(o(l)(`questionnaire.preferenceOptions.${e}`)),11,Fs)),64))])]),n("div",Hs,[n("p",Bs,a(o(l)("newQuestions.explainChoice")),1),n("textarea",{value:o(t).getFinalResponse("comment"),onInput:r[4]||(r[4]=e=>o(t).setFinalResponse("comment",e.target.value)),class:"feedback-input",rows:"3"},null,40,qs)])])):T("",!0)]),n("div",Vs,[o(t).taskStep==="final"?(p(),d("button",{key:0,class:P(["btn submit-btn",{"btn-primary":!o(t).isSubmitting&&o(t).submitStatus===null,"btn-success":o(t).submitStatus==="success","btn-error":o(t).submitStatus==="error"}]),disabled:o(t).isSubmitting,onClick:Je},[o(t).isSubmitting?(p(),d("span",Os)):o(t).submitStatus==="success"?(p(),d("span",Xs,"âœ“ "+a(o(l)("common.submitSuccess")),1)):o(t).submitStatus==="error"?(p(),d("span",Ys,"âœ— "+a(o(l)("common.submitError")),1)):(p(),d("span",zs,a(o(l)("common.submit")),1))],10,Is)):(p(),d("button",{key:1,class:"btn btn-primary next-btn",onClick:Ee,disabled:!ae.value},a(o(l)("common.next")),9,Ns)),ae.value?T("",!0):(p(),d("p",Ws,a(Fe.value),1))])])):T("",!0)])]))}},Zs=et(Us,[["__scopeId","data-v-4d6e38b9"]]);export{Zs as default};
